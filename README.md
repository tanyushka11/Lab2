Бобина Татьяна Сергеевна ПМИ3-1

Самостоятельная работа 2
1 вариант: 

1) Данные своего варианта разделила на выборку для построения
моделей (80%) и отложенные наблюдения (20%). Оставила в таблице только указанные в
варианте переменные. 
2) Рассчитала описательные статистики для непрерывных переменных. 
Из таблицы ниже можно видеть, что переменная medv, которая является зависимой переменной модели, 
отличается по масштабу от всех остальных. 
Также заметим, что из всех объясняющих только переменная zn и tax_over_400 принимает нулевые значения.
Построила графики взаимного разброса непрерывных переменных.
Судя по этим графикам:
	1. распределение зависимой medv является нормальным;
	2. из всех объясняющих нет нормально распределенных переменных;
	3. облако наблюдений на графике medv от zn делится на три неравные части;
	4. нет дискретных переменных, что очевидно из их смысла.

Построили корреляционные матрицы непрерывных переменных фрейма.
	корреляционная матрица по всем наблюдениям: Слабая связь между переменными medv и indus, слабая связь между переменными indus и zn. 
Очень слабая связь между переменными medv и zn.

	корреляционная матрица по классу полной ставки налога на имущество на $10000 превышает 400: 
Связь по классу полной ставки налога на имущество превышает 400 между переменными medv и zn, medv и indus отсутствует.

	корреляционная матрица по классу полной ставки налога на имущество на $10000 не превышает 400:
Связь по классу полной ставки налога на имущество не превышает 400 между переменными medv и zn, medv и indus очень слабая. 
Между zn и indus связь  слабая.

3) Проверить Y на нормальность.

medv Statistics=0.92, p=0.0000
Распределение не нормально (H0 отклоняется)

log_medv Statistics=0.98, p=0.0000
Распределение не нормально (H0 отклоняется)

	корреляционная матрица по классу полной ставки налога на имущество на $10000 превышает 400:
Связь по классу полной ставки налога на имущество превышает 400 между переменными log_medv и zn, log_medv и indus отсутствует.
Между zn и indus средняя.
	корреляционная матрица по классу полной ставки налога на имущество на $10000 не превышает 400
 Связь по классу полной ставки налога на имущество не превышает 400 между переменными log_medv и zn, log_medv и indus слабая. 
Между zn и indus связь  слабая.

4) Составить список возможных спецификаций моделей множественной регрессии (на
исходной Y и на логарифме Y ).

По итогам предварительного анализа данных можно предложить следующие спецификации линейных регрессионных моделей:

fit_lm_1:  𝑚𝑒𝑑𝑣^=𝛽0^+𝛽1^⋅𝑡𝑎𝑥_𝑜𝑣𝑒𝑟_400+𝛽2^⋅𝑧𝑛+𝛽3^⋅𝑖𝑛𝑑𝑢𝑠 
fit_lm_2:  𝑚𝑒𝑑𝑣^=𝛽0^+𝛽1^⋅𝑡𝑎𝑥_𝑜𝑣𝑒𝑟_400+𝛽2^⋅𝑧𝑛⋅𝑡𝑎𝑥_𝑜𝑣𝑒𝑟_400+𝛽3^⋅𝑖𝑛𝑑𝑢𝑠 
fit_lm_3:  𝑚𝑒𝑑𝑣^=𝛽0^+𝛽1^⋅𝑡𝑎𝑥_𝑜𝑣𝑒𝑟_400+𝛽2^⋅𝑖𝑛𝑑𝑢𝑠⋅𝑡𝑎𝑥_𝑜𝑣𝑒𝑟_400+𝛽3^⋅𝑧𝑛 
fit_lm_4:  𝑚𝑒𝑑𝑣^=𝛽0^+𝛽1^⋅𝑡𝑎𝑥_𝑜𝑣𝑒𝑟_400+𝛽2^⋅𝑖𝑛𝑑𝑢𝑠⋅𝑡𝑎𝑥_𝑜𝑣𝑒𝑟_400+𝛽3^⋅𝑧𝑛⋅𝑡𝑎𝑥_𝑜𝑣𝑒𝑟_400 
fit_lm_1_log: то же, что fit_lm_1, но для зависимой  𝑙𝑜𝑔_𝑚𝑒𝑑𝑣^ 

fit_lm_2_log: то же, что fit_lm_2, но для зависимой  𝑙𝑜𝑔_𝑚𝑒𝑑𝑣^ 
fit_lm_3_log: то же, что fit_lm_3, но для зависимой  𝑙𝑜𝑔_𝑚𝑒𝑑𝑣^ 
fit_lm_4_log: то же, что fit_lm_4, но для зависимой  𝑙𝑜𝑔_𝑚𝑒𝑑𝑣^ 
Кроме того, добавим в сравнение модели зависимости medv и log_medv от всех объясняющих переменных: fit_lm_0 и fit_lm_0_log соответственно.

5) 
Наименьшая ошибка на тестовой с LOOCV у модели fit_lm_0 :
MSE_loocv = 7.0
Наименьшая ошибка на тестовой с LOOCV у модели fit_lm_0_log :
MSE_loocv = 0.0
Самой точной среди моделей для medv оказалась fit_lm_0, а среди моделей для medv_log – fit_lm_0_log

6)
MSE модели fit_lm_0_log на отложенных наблюдениях = 511.07
MSE модели fit_lm_0 на отложенных наблюдениях = 2325.36
Очевидно, на выборке для прогноза точнее модель fit_lm_0_log